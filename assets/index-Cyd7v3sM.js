import{r as a,j as i,t as ne}from"./iframe-DGiRyBXK.js";import{c}from"./emotion-styled-base.browser.esm-DOJJeMjc.js";import{B as x}from"./index-CAB9-Wky.js";import{S as re}from"./index-VFDZBhwq.js";import{P as ae}from"./index-BIXc_CGl.js";import{C as ie}from"./index-yh91TgFT.js";const z=t=>{const v=Math.floor(t/60),y=Math.floor(t%60),h=String(v).padStart(2,"0"),d=String(y).padStart(2,"0");return`${h}:${d}`},se=c("div",{target:"e1jdwgrz9"})("position:relative;width:100%;max-width:800px;background-color:#000;border-radius:",t=>t.theme.borderRadius.md,";overflow:hidden;box-shadow:",t=>t.theme.shadows.lg,";aspect-ratio:16/9;display:flex;justify-content:center;align-items:center;object-fit:contain;&:hover .controls-overlay{opacity:1;}"),oe=c("video",{target:"e1jdwgrz8"})({name:"29i6ub",styles:"width:100%;height:100%;display:block;object-fit:contain;background-color:black"}),le=c("img",{target:"e1jdwgrz7"})({name:"1235t56",styles:"position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;z-index:1"}),ce=c("div",{target:"e1jdwgrz6"})(`position:absolute;bottom:0;left:0;right:0;height:100%;display:flex;flex-direction:column;justify-content:flex-end;background:linear-gradient(
    to top,
    rgba(0, 0, 0, 0.7) 0%,
    rgba(0, 0, 0, 0) 100%
  );opacity:`,t=>t.show?1:0,";transition:opacity 0.3s ease-in-out;pointer-events:",t=>t.show?"auto":"none",";z-index:2;"),ue=c("div",{target:"e1jdwgrz5"})("display:flex;align-items:center;padding:",t=>t.theme.spacing.sm," ",t=>t.theme.spacing.lg,";gap:",t=>t.theme.spacing.md,";color:#fff;flex-wrap:wrap;"),de=c("span",{target:"e1jdwgrz4"})("font-family:",t=>t.theme.typography.fontFamily,";font-size:",t=>t.theme.typography.bodySmall.fontSize,";color:#fff;white-space:nowrap;"),pe=c("div",{target:"e1jdwgrz3"})("display:flex;flex-direction:row;align-items:center;gap:",t=>t.theme.spacing.md,";width:120px;flex-shrink:0;"),me=c("div",{target:"e1jdwgrz2"})("position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(0, 0, 0, 0.8);display:flex;align-items:center;justify-content:center;z-index:10;padding:",t=>t.theme.spacing.xl,";&>div{max-width:90%;max-height:90%;overflow-y:auto;}"),fe=c("div",{target:"e1jdwgrz1"})("position:relative;width:calc(100% - 20px);margin-inline:auto;height:",t=>t.theme.spacing.sm,";cursor:pointer;"),ge=c("div",{target:"e1jdwgrz0"})("position:absolute;top:50%;left:",t=>t.position,"%;transform:translate(-50%, -50%);width:8px;height:8px;background-color:",t=>t.theme.colors.secondary[40],";border-radius:",t=>t.theme.borderRadius.full,";z-index:5;pointer-events:none;"),he=({src:t,title:v="Video Player",autoPlay:y=!1,loop:h=!1,muted:d=!1,interrupts:T=[],placeholderImage:q,onPlay:M,onPause:L,onPlayerVolumeChange:F,onPlayerTimeUpdate:H,onFullScreenChange:R,onInterruptActive:G,onInterruptDismiss:A,onEnded:W,...X})=>{const n=a.useRef(null),b=a.useRef(null),[k,o]=a.useState({isPlaying:y,currentTime:0,duration:0,volume:d?0:1,isMuted:d,isFullScreen:!1,showControls:!0,hasPlayed:!1,currentInterrupt:null,isInterruptActive:!1}),E=a.useRef(new Set),p=a.useRef(null),{isPlaying:l,currentTime:B,duration:m,volume:w,isMuted:f,isFullScreen:u,showControls:_,hasPlayed:D,currentInterrupt:$,isInterruptActive:s}=k,C=a.useCallback(()=>{o(e=>({...e,isPlaying:!0,hasPlayed:!0})),M?.()},[M]),P=a.useCallback(()=>{o(e=>({...e,isPlaying:!1})),L?.()},[L]),j=a.useCallback(()=>{if(!n.current)return;const e=n.current.currentTime;if(o(r=>({...r,currentTime:e})),H?.(e,k.duration),!s){for(const r of T)if(e>=r.timestampSeconds&&e<r.timestampSeconds+.5&&!E.current.has(r.id)){n.current.pause(),o(g=>({...g,currentInterrupt:r,isInterruptActive:!0})),E.current.add(r.id),G?.(r);break}}},[T,s,H,G,k.duration]),V=a.useCallback(()=>{n.current&&(o(e=>({...e,duration:n.current.duration})),n.current.volume=d?0:1)},[d]),I=a.useCallback(()=>{if(n.current){const e=n.current.volume,r=n.current.muted;o(g=>({...g,volume:e,isMuted:r})),F?.(e,r)}},[F]),S=a.useCallback(()=>{o(e=>({...e,isPlaying:!1})),n.current&&!h&&(n.current.currentTime=0),E.current.clear(),o(e=>({...e,hasPlayed:!1})),W?.()},[h,W]),N=a.useCallback(()=>{const e=document.fullscreenElement===b.current;o(r=>({...r,isFullScreen:e})),R?.(e)},[R]);a.useEffect(()=>{const e=n.current;if(e)return e.addEventListener("play",C),e.addEventListener("pause",P),e.addEventListener("timeupdate",j),e.addEventListener("loadedmetadata",V),e.addEventListener("volumechange",I),e.addEventListener("ended",S),()=>{e.removeEventListener("play",C),e.removeEventListener("pause",P),e.removeEventListener("timeupdate",j),e.removeEventListener("loadedmetadata",V),e.removeEventListener("volumechange",I),e.removeEventListener("ended",S)}},[C,P,j,V,I,S]),a.useEffect(()=>(document.addEventListener("fullscreenchange",N),()=>document.removeEventListener("fullscreenchange",N)),[N]),a.useEffect(()=>{(!l||u||s)&&(o(e=>({...e,showControls:!0})),p.current&&clearTimeout(p.current))},[l,u,s]);const O=a.useCallback(async()=>{s||n.current&&(l?await n.current.pause():await n.current.play().catch(e=>{console.error("Failed to play video via user interaction:",e)}))},[l,s]),J=a.useCallback(e=>{if(n.current){const r=e/100*m;n.current.currentTime=r,o(g=>({...g,currentTime:r}))}},[m]),U=a.useCallback(e=>{if(n.current){const r=e/100;n.current.volume=r}},[]),K=a.useCallback(()=>{n.current&&(n.current.muted=!f,f&&n.current.volume===0&&(n.current.volume=.5))},[f]),Q=a.useCallback(()=>{b.current&&(document.fullscreenElement?document.exitFullscreen():b.current.requestFullscreen().catch(e=>{console.error(`Error attempting to enable full-screen mode: ${e.message} (${e.name})`)}))},[]),Y=a.useCallback(()=>{o(e=>({...e,showControls:!0})),p.current&&clearTimeout(p.current),p.current=setTimeout(()=>{l&&!u&&!s&&o(e=>({...e,showControls:!1}))},3e3)},[l,u,s]),Z=a.useCallback(()=>{l&&!u&&!s&&o(e=>({...e,showControls:!1})),p.current&&clearTimeout(p.current)},[l,u,s]),ee=a.useCallback(()=>{o(e=>({...e,isInterruptActive:!1,currentInterrupt:null})),A?.(),n.current&&n.current.play().catch(e=>console.error("Resume play failed:",e))},[A]);return i.jsxs(se,{ref:b,onMouseMove:Y,onMouseLeave:Z,onClick:O,title:v,...X,children:[q&&(!D||!l)&&i.jsx(le,{src:q,alt:`${v} placeholder`}),i.jsx(oe,{ref:n,src:t,loop:h,autoPlay:y,muted:d,preload:"metadata",controls:!1}),s&&$&&i.jsx(me,{children:i.jsxs(ie,{style:{maxWidth:"400px",width:"100%",textAlign:"center"},children:[$.content,i.jsx(x,{variant:"primary",onClick:e=>{e.stopPropagation(),ee()},style:{marginTop:ne.spacing.md},"aria-label":"Continue video playback",children:"Continue"})]})}),i.jsxs(ce,{show:_||!l||u,className:"controls-overlay",children:[i.jsxs(fe,{onClick:e=>{if(s){e.stopPropagation();return}if(n.current&&e.currentTarget){const r=e.currentTarget.getBoundingClientRect(),te=(e.clientX-r.left)/r.width*100;J(te)}},children:[i.jsx(ae,{value:B/m*100||0,max:100,style:{cursor:"pointer"}}),T.map(e=>{const r=e.timestampSeconds/m*100;return m>0&&!isNaN(r)&&isFinite(r)?i.jsx(ge,{position:r,title:`Interrupt at ${z(e.timestampSeconds)}`},e.id):null})]}),i.jsxs(ue,{children:[i.jsx(x,{"aria-label":l?"pause":"play",variant:"icon",size:"sm",onClick:e=>{e.stopPropagation(),O()},style:{color:"#fff"},disabled:s,children:l?"fa-solid fa-pause":"fa-solid fa-play"}),i.jsxs(pe,{children:[i.jsx(x,{"aria-label":f||w===0?"volume mute":"volume up",variant:"icon",style:{minWidth:"32px",color:"#fff"},size:"sm",onClick:e=>{e.stopPropagation(),K()},disabled:s,children:f||w===0?"fa-solid fa-volume-mute":w>.5?"fa-solid fa-volume-up":"fa-solid fa-volume-down"}),i.jsx(re,{min:0,max:100,step:1,value:f?0:w*100,onValueChange:U,onClick:e=>e.stopPropagation(),style:{flexGrow:1},disabled:s})]}),i.jsxs(de,{children:[z(B)," / ",z(m)]}),i.jsx("div",{style:{flexGrow:1}}),i.jsx(x,{variant:"icon",size:"sm",onClick:e=>{e.stopPropagation(),Q()},style:{color:"#fff"},disabled:s,"aria-label":u?"Exit fullscreen":"Enter fullscreen",children:u?"fa-solid fa-compress-arrows-alt":"fa-solid fa-expand-arrows-alt"})]})]})]})};he.__docgenInfo={description:`The **VideoPlayer** is a comprehensive and interactive component designed for embedding video content within the learning platform. It goes beyond standard playback by integrating features specifically for educational purposes, such as interactive interrupts. This component ensures a consistent, accessible, and engaging video experience for all users, abstracting the complexities of the HTML5 video API into a simple, prop-driven interface built with components from our own design system.

\`\`\`typescript
import { VideoPlayer } from "@activityeducation/component-library";
\`\`\`

## Justification
For the application, the \`VideoPlayer\` serves as a cornerstone for delivering dynamic educational content. By providing a standardized player, we ensure a uniform look, feel, and functionality across all courses and modules, which reinforces the platform's professional and cohesive identity. The component's most significant feature, **interactive interrupts**, transforms video from a passive medium into an active learning tool. This allows instructional designers to embed questions, key takeaways, or supplementary materials directly into the video timeline, creating opportunities for formative assessment and deeper engagement. Encapsulating this functionality within a single, reusable component drastically simplifies development and content creation, allowing for rapid deployment of rich, interactive video lessons.

From the end-user's perspective, the \`VideoPlayer\` offers a familiar and intuitive interface that minimizes cognitive load and allows them to focus on the learning material. The custom controls are clear and accessible, and the visual markers for interrupts on the progress bar set clear expectations, letting learners know when interaction points are coming up. This feature enhances the learning process by breaking up long videos, reinforcing key concepts at crucial moments, and providing immediate opportunities for self-assessment. The inclusion of a placeholder image and smooth transitions creates a polished, high-quality experience that builds user confidence and makes the learning journey more engaging and effective.

## Acceptance Criteria
- **GIVEN** a user views a page with the \`VideoPlayer\`, **WHEN** the video is playing, **THEN** the controls should automatically hide after 3 seconds of mouse inactivity.
- **GIVEN** a user views a video with interrupts defined, **WHEN** the video playback time reaches an interrupt's timestamp, **THEN** the video must pause and the interrupt's content must be displayed in an overlay \`Card\`.
- **GIVEN** an interrupt is displayed, **WHEN** the user clicks the "Continue" button, **THEN** the overlay must disappear and the video must resume playing.
- **GIVEN** a user hovers over the progress bar, **WHEN** interrupts are defined, **THEN** markers should be visible on the progress bar at the corresponding timestamps.
- **GIVEN** the \`placeholderImage\` prop is provided, **WHEN** the video has not yet been played, **THEN** the placeholder image must be visible.
- **GIVEN** the video is playing and the user pauses it, **THEN** the placeholder image should become visible again if it was provided.
- **GIVEN** a user clicks anywhere on the video viewport, **THEN** the video's play/pause state should toggle accordingly.
- **GIVEN** a user clicks the fullscreen button, **THEN** the player should attempt to enter or exit fullscreen mode.


## Example & Props`,methods:[],displayName:"VideoPlayer",props:{src:{required:!0,tsType:{name:"string"},description:""},title:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"Video Player"',computed:!1}},autoPlay:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},muted:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},loop:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},interrupts:{required:!1,tsType:{name:"Array",elements:[{name:"VideoInterrupt"}],raw:"VideoInterrupt[]"},description:"",defaultValue:{value:"[]",computed:!1}},placeholderImage:{required:!1,tsType:{name:"string"},description:""},css:{required:!1,tsType:{name:"SerializedStyles"},description:""},onPlay:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onPause:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onPlayerVolumeChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(volume: number, isMuted: boolean) => void",signature:{arguments:[{type:{name:"number"},name:"volume"},{type:{name:"boolean"},name:"isMuted"}],return:{name:"void"}}},description:""},onPlayerTimeUpdate:{required:!1,tsType:{name:"signature",type:"function",raw:"(currentTime: number, duration: number) => void",signature:{arguments:[{type:{name:"number"},name:"currentTime"},{type:{name:"number"},name:"duration"}],return:{name:"void"}}},description:""},onFullScreenChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(isFullScreen: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"isFullScreen"}],return:{name:"void"}}},description:""},onInterruptActive:{required:!1,tsType:{name:"signature",type:"function",raw:"(interrupt: VideoInterrupt) => void",signature:{arguments:[{type:{name:"VideoInterrupt"},name:"interrupt"}],return:{name:"void"}}},description:""},onInterruptDismiss:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onEnded:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}},composes:["Omit"]};export{he as V};
