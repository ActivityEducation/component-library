import{r as t,j as i}from"./iframe-XJf-RO9W.js";import"./index-C2jQ6SkN.js";import{B as T}from"./index-ByguWD-9.js";import{C as J}from"./index-BmzST_Tt.js";import"./index-B3-2WBgO.js";import"./index-ImqK2cea.js";import"./index-B7iyCpam.js";import{I as P}from"./index-guuBgZ9n.js";import{I as Z}from"./index-D1S9llNI.js";import"./index-BevCfjQH.js";import"./index-DaQSjhOt.js";import"./index-CD-Z_Pzg.js";import"./index-T9m_uaHX.js";import"./index-DwKSXbOR.js";import"./index-C0ZroZ3A.js";import"./index-BeI4ymMm.js";import"./index-B6iSQPDi.js";import"./index-DPmmUMJ_.js";import"./index-Cuppfap7.js";import{T as G}from"./index-hKkMw5Tq.js";import"./index-Dq57-o_O.js";import"./index-Cp3CGPsa.js";import"./index-BPlyJI9X.js";import"./index-GibhputC.js";import"./ObjectiveProgress-Dz16heLb.js";import"./UpcomingDeadlines-C4znN0P-.js";import"./emotion-styled.browser.esm-Zt9Xnlbb.js";import"./emotion-react.browser.esm-DE_3pz7Q.js";import"./index-CegwbtpY.js";import"./index-C4kivIfZ.js";const ee=({content:e,onDelete:L,onUpdate:w,onTransform:y,readOnly:o,currentSide:m,setDraggedItemGlobal:S,setDraggedSideGlobal:u,setDraggedOverContainerGlobal:R,handleDropGlobal:B})=>{const[b,W]=t.useState(!1),[p,A]=t.useState(!1),D=t.useRef(null),h=t.useRef(null),j=t.useRef(null),[f,N]=t.useState(!1),[M,a]=t.useState({x:0,y:0}),[r,l]=t.useState(!1),[n,g]=t.useState({width:0,height:0}),[d,C]=t.useState({x:0,y:0});t.useEffect(()=>{b&&D.current&&D.current.focus(),p&&j.current&&j.current.focus()},[b,p]);const E=t.useCallback(()=>{!o&&e.type==="text"&&W(!0)},[o,e.type]),x=t.useCallback(()=>{D.current&&e.type==="text"&&w(e.id,D.current.innerHTML),W(!1)},[e.id,e.type,w]),z=t.useCallback(()=>{!o&&e.type==="image"&&A(!0)},[o,e.type]),k=t.useCallback(()=>{j.current&&e.type==="image"&&w(e.id,j.current.value),A(!1)},[e.id,e.type,w]),$=t.useCallback(s=>{s.key==="Enter"&&k()},[k]),V=t.useCallback(s=>{if(o||b||p||s.target.classList.contains("resize-handle"))return;N(!0),S(e),u(m);const c=h.current.getBoundingClientRect();a({x:s.clientX-c.left,y:s.clientY-c.top}),s.preventDefault()},[o,b,p,e,m,S,u]),X=t.useCallback(s=>{if(r){const c=s.clientX-d.x,F=s.clientY-d.y;let v=n.width+c,I=n.height+F;v=Math.max(50,v),I=Math.max(50,I);const O=h.current.parentElement.getBoundingClientRect();v=Math.min(v,O.width-e.x),I=Math.min(I,O.height-e.y),y(e.id,e.x,e.y,v,I)}else if(f){const c=h.current.parentElement.getBoundingClientRect();let F=s.clientX-c.left-M.x,v=s.clientY-c.top-M.y;F=Math.max(0,Math.min(F,c.width-h.current.offsetWidth)),v=Math.max(0,Math.min(v,c.height-h.current.offsetHeight)),y(e.id,F,v,e.width,e.height)}},[r,f,M,n,d,e,y]),Y=t.useCallback(s=>{if(f){N(!1),S(null),u(null),R(null);const c=s.target.closest(".flashcard-side-drop-target");c&&c.dataset.side&&c.dataset.side!==m&&B(s,c.dataset.side,e.id,m)}else r&&l(!1)},[f,r,e.id,m,S,u,R,B]),Q=t.useCallback(s=>{o||(l(!0),g({width:h.current.offsetWidth,height:h.current.offsetHeight}),C({x:s.clientX,y:s.clientY}),s.stopPropagation(),s.preventDefault())},[o]);return t.useEffect(()=>(f||r?(document.addEventListener("mousemove",X),document.addEventListener("mouseup",Y)):(document.removeEventListener("mousemove",X),document.removeEventListener("mouseup",Y)),()=>{document.removeEventListener("mousemove",X),document.removeEventListener("mouseup",Y)}),[f,r,X,Y]),i.jsxs("div",{ref:h,className:`absolute p-3 bg-background-DEFAULT rounded-md shadow-md border border-border-DEFAULT group transition-all duration-100 ease-out flex flex-col justify-center items-center overflow-hidden
                  ${o?"":"cursor-grab"}
                  ${f?"z-50 shadow-xl ring-4 ring-primary-40":"z-10"}
                  `,style:{left:e.x,top:e.y,width:e.width,height:e.height,minWidth:"50px",minHeight:"50px"},onMouseDown:V,children:[e.type==="text"?i.jsx("div",{ref:D,contentEditable:b&&!o,onDoubleClick:E,onBlur:x,dangerouslySetInnerHTML:{__html:e.value||'<p class="text-text-placeholder">Double-click to edit text</p>'},className:`w-full h-full p-2 text-text-DEFAULT break-words overflow-auto no-scrollbar
            ${b?"border border-border-focus rounded-md ring-2 ring-primary-20":""} ${o?"cursor-default":""}`,suppressContentEditableWarning:!0}):p?i.jsx(Z,{type:"text",defaultValue:e.value,onBlur:k,onKeyDown:$,className:"w-full h-full p-2 text-sm",placeholder:"Enter image URL"}):i.jsx("img",{src:e.value,alt:"Flashcard content",className:"max-w-full max-h-full object-contain rounded-md cursor-pointer",onDoubleClick:z,onError:s=>{s.currentTarget.src=`https://placehold.co/${e.width||150}x${e.height||100}/eeeeee/aaaaaa?text=Image+Load+Error`,s.currentTarget.onerror=null}}),!o&&i.jsxs(i.Fragment,{children:[i.jsx(T,{onClick:()=>L(e.id),"aria-label":"Delete content",title:"Delete content",variant:"icon",size:"sm",children:i.jsx(P,{name:"trash-2",className:"text-text-onError",size:"sm"})}),i.jsx("div",{className:"resize-handle absolute bottom-0 right-0 w-4 h-4 bg-neutral-70 rounded-br-md cursor-nwse-resize opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-30 flex items-center justify-center",onMouseDown:Q,title:"Resize",children:i.jsx(P,{name:"resize-handle",className:"text-text-light",size:"sm"})})]})]})},q=({initialCardData:e,onSave:L,readOnly:w=!1})=>{const[y,o]=t.useState(e),[m,S]=t.useState("front"),[u,R]=t.useState(null),[B,b]=t.useState(null),[W,p]=t.useState(null);t.useEffect(()=>{o(e)},[e]);const A=t.useCallback((a,r,l)=>{o(n=>{const g=n[a].map(d=>d.id===r?{...d,value:l}:d);return{...n,[a]:g}})},[]),D=t.useCallback((a,r,l,n,g,d)=>{o(C=>{const E=C[a].map(x=>x.id===r?{...x,x:l,y:n,width:g,height:d}:x);return{...C,[a]:E}})},[]),h=t.useCallback((a,r)=>{const l={id:Date.now().toString()+Math.random().toString(36).substring(2,9),type:r,value:r==="text"?"":"https://placehold.co/150x100/eeeeee/aaaaaa?text=New+Image",x:50,y:50,width:r==="text"?200:150,height:r==="text"?80:100};o(n=>({...n,[a]:[...n[a],l]}))},[]),j=t.useCallback((a,r)=>{o(l=>({...l,[a]:l[a].filter(n=>n.id!==r)}))},[]),f=t.useCallback((a,r,l,n)=>{a.preventDefault(),p(null),!(!u||r===n)&&(o(g=>{let d={...g};const C=d[n].findIndex($=>$.id===l);if(C===-1)return g;const[E]=d[n].splice(C,1),x=a.currentTarget.getBoundingClientRect();let z=a.clientX-x.left-(u?u.width/2:0),k=a.clientY-x.top-(u?u.height/2:0);return z=Math.max(0,Math.min(z,x.width-E.width)),k=Math.max(0,Math.min(k,x.height-E.height)),d[r].push({...E,x:z,y:k}),d}),R(null),b(null))},[u]),N=t.useCallback(()=>{L(y),console.log("Flashcard saved:",y)},[y,L]),M=a=>i.jsx(J,{"data-side":a,onDragOver:r=>r.preventDefault(),onDrop:r=>f(r,a,u?.id||"",B||"front"),onDragEnter:()=>p(a),onDragLeave:()=>p(null),children:i.jsxs("div",{children:[y[a].length===0&&!w&&i.jsx("p",{children:'Click "Add Text" or "Add Image" to place content.'}),y[a].map(r=>i.jsx(ee,{content:r,onDelete:l=>j(a,l),onUpdate:(l,n)=>A(a,l,n),onTransform:(l,n,g,d,C)=>D(a,l,n,g,d,C),readOnly:w,currentSide:a,setDraggedItemGlobal:R,setDraggedSideGlobal:b,setDraggedOverContainerGlobal:p,handleDropGlobal:f},r.id))]})});return i.jsxs("div",{style:{display:"flex",padding:"10px",flexDirection:"column"},children:[!w&&i.jsxs(G,{style:{marginBottom:"20px",borderRadius:"0px"},children:[i.jsx("h3",{children:m}),i.jsx(T,{onClick:()=>S(m==="front"?"back":"front"),variant:"tertiary",size:"sm",children:"Flip Card"}),i.jsx(T,{onClick:()=>h(m,"text"),variant:"secondary",size:"sm",children:"Add Text"}),i.jsx(T,{onClick:()=>h(m,"image"),variant:"primary",size:"sm",children:"Add Image"}),i.jsx(T,{size:"sm",onClick:N,children:"Save Flashcard"})]}),i.jsx("div",{children:M(m==="front"?"front":"back")})]})};q.__docgenInfo={description:"",methods:[],displayName:"FlashcardEditor",props:{initialCardData:{required:!0,tsType:{name:"FlashcardData"},description:""},onSave:{required:!0,tsType:{name:"signature",type:"function",raw:"(updatedCard: FlashcardData) => void",signature:{arguments:[{type:{name:"FlashcardData"},name:"updatedCard"}],return:{name:"void"}}},description:""},readOnly:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}}}};const K={front:[{id:"f1",type:"text",value:'<p class="text-xl font-medium">What is the capital of <strong class="text-primary-60">France</strong>?</p>',x:50,y:50,width:300,height:80},{id:"f2",type:"image",value:"https://placehold.co/150x100/ADD8E6/000000?text=Question",x:100,y:180,width:150,height:100}],back:[{id:"b1",type:"text",value:'<p class="text-xl font-medium">The capital of France is <strong class="text-secondary-60">Paris</strong>.</p><p class="text-sm text-neutral-60">Known as the City of Love.</p>',x:50,y:50,width:350,height:120},{id:"b2",type:"image",value:"https://placehold.co/150x100/FFB6C1/000000?text=Answer",x:200,y:180,width:150,height:100}]},te={front:[],back:[]},Ie={title:"Components/FlashcardEditor",component:q,tags:["autodocs"],parameters:{layout:"fullscreen"},argTypes:{initialCardData:{control:"object",description:"The initial data for the flashcard (front and back content, including position and size)."},onSave:{action:"cardSaved",description:'Callback function triggered when the "Save Flashcard" button is clicked.'},readOnly:{control:"boolean",description:"If true, the editor will be in read-only mode, disabling editing, dragging, and resizing."}},args:{onSave:e=>console.log("Flashcard data saved:",e)}},_={args:{initialCardData:K,readOnly:!1}},H={args:{initialCardData:K,readOnly:!0},name:"Read-Only Mode"},U={args:{initialCardData:te,readOnly:!1},name:"Empty Flashcard"};_.parameters={..._.parameters,docs:{..._.parameters?.docs,source:{originalSource:`{
  args: {
    initialCardData: defaultCardData,
    readOnly: false
  }
}`,..._.parameters?.docs?.source}}};H.parameters={...H.parameters,docs:{...H.parameters?.docs,source:{originalSource:`{
  args: {
    initialCardData: defaultCardData,
    readOnly: true
  },
  name: 'Read-Only Mode' // Custom name for the story in Storybook UI
}`,...H.parameters?.docs?.source}}};U.parameters={...U.parameters,docs:{...U.parameters?.docs,source:{originalSource:`{
  args: {
    initialCardData: emptyCardData,
    readOnly: false
  },
  name: 'Empty Flashcard'
}`,...U.parameters?.docs?.source}}};const Te=["Default","ReadOnlyMode","EmptyFlashcard"];export{_ as Default,U as EmptyFlashcard,H as ReadOnlyMode,Te as __namedExportsOrder,Ie as default};
